/*
 *  Content Edit - v0.1.1
 *  HTML Content Edit (jQuery) plugin. To edit content with a more complex workflow than just an inline editable.
 *  https://github.com/oncletom/content-edit
 *
 *  Made by Thomas Parisot
 *  Under Apache-2.0 License
 */
!function(a){"use strict";function b(a){this.editable=a,this.historyElement=null,this.init(a)}b.namespace="history",b.prototype.init=function(a){this.historyElement=this.resolveHistoryElement(a)},b.prototype.resolveHistoryElement=function(c){for(var d,e=a(c.templateElement),f=c.selector(b.namespace),g=[function(a){return e.siblings(a)},function(b){return a(b)}];!d&&g;)d=g.shift()(f).get(0);return d},b.prototype.idle=function(){a(this.historyElement).addClass("hidden"),a(this.historyElement).data("content-edit-source",null)},b.prototype.editing=function(){a(this.historyElement).data("content-edit-source",this.editable),a(this.historyElement).removeClass("hidden")},b.prototype.revertRevision=function(a){this.copyRevision(a),this.editable.setState("saving")},b.prototype.copyRevision=function(b){this.editable.setContent(a(b).find("[data-editable-history-revision]").html().trim())},b.UIStateHandler=function(a,c){var d=c.plugins[b.namespace];d||(d=c.plugins[b.namespace]=new b(c)),d.historyElement&&d[c.state]&&d[c.state](a)},b.processRevisionAction=function(){var c=b.namespace,d=a(this).parents("[data-editable-"+c+"]").data("content-edit-source"),e=this.getAttribute("data-editable-"+c+"-action")+"Revision",f=d.plugins[c];f.historyElement&&f[e]&&f[e](a(this).parents(".editable-history-item").get(0))},b.dispatch=function(a){a.on("editable.any","[data-editable]",b.UIStateHandler),a.on("click","a[data-editable-history-action]",b.processRevisionAction)},a.fn.editable.historyPluginConstructor=b,b.dispatch(a(document))}(jQuery,document,window);